<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>AAzure</bpr:name>
    <bpr:release-notes />
    <bpr:created>2021-07-09 13:18:24Z</bpr:created>
    <bpr:package-id>103</bpr:package-id>
    <bpr:package-name>VisionAPI</bpr:package-name>
    <bpr:user-created-by>RPA1706@newday.co.uk</bpr:user-created-by>
    <bpr:contents count="5">
        <object id="8986fb8f-b8fd-4922-971b-f9f9b8a3950f" name="AzureAD" xmlns="http://www.blueprism.co.uk/product/process"><process name="AzureAD" version="1.0" bpversion="6.4.3.13244" narrative="" byrefcollection="true" type="object" runmode="Exclusive"><appdef><element name="Application Root"><id>322e1264-2864-421b-89bc-749c833da2d3</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>0</camerax><cameray>-1</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="6fdfb4da-de9f-4e41-be5c-d53003a78708" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="798c3018-2b3f-494a-a536-d1b2b7fd15ec" type="Normal" published="True"><name>Get Bearer Token</name><view><camerax>0</camerax><cameray>150</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="310f0735-7466-44a2-923e-0997e4a8320c" type="Normal" published="False"><name>Get Details from Vault</name><view><camerax>-105</camerax><cameray>300</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="1ab47c92-5133-4d61-a56e-ea9111cc2626" type="Normal" published="False"><name>Request Bearer Token (v1 Endpoint)</name><view><camerax>20</camerax><cameray>63</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ba330b98-d2a0-4be7-a290-2f8e32f0f236" type="Normal" published="False"><name>Save Token to Vault</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="5f5c0682-3e90-4be4-9474-9fff43a50c33" name="Start" type="Start"><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>a23de4cd-451d-42d7-8da4-1bf6d1e78522</onsuccess></stage><stage stageid="a23de4cd-451d-42d7-8da4-1bf6d1e78522" name="End" type="End"><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="937a5213-49da-40dd-8805-0c4f6185fe36" name="Stage1" type="ProcessInfo"><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><references><reference>System.dll</reference><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference><reference>System.Web.dll</reference></references><imports><import>System</import><import>System.Drawing</import><import>System.Data</import><import>System.Web</import></imports><language>visualbasic</language><globalcode><![CDATA[]]></globalcode><code><![CDATA[]]></code></stage><stage stageid="06a3617e-c931-4556-b363-e1f40cdc656b" name="Clean Up" type="SubSheetInfo"><subsheetid>6fdfb4da-de9f-4e41-be5c-d53003a78708</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="c4fdf86f-961d-4ae3-903f-766ce7a4153e" name="Start" type="Start"><subsheetid>6fdfb4da-de9f-4e41-be5c-d53003a78708</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>897f08d3-3f5b-40cb-8965-26eb2788403c</onsuccess></stage><stage stageid="897f08d3-3f5b-40cb-8965-26eb2788403c" name="End" type="End"><subsheetid>6fdfb4da-de9f-4e41-be5c-d53003a78708</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="af5b4878-e2dc-4d89-89e7-3c724206fa9c" name="Note1" type="Note"><subsheetid>6fdfb4da-de9f-4e41-be5c-d53003a78708</subsheetid><loginhibit onsuccess="true" /><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="a52d9b30-e40b-498a-94cd-a98c1ea7d70e" name="Request Bearer Token (v1 Endpoint)" type="SubSheetInfo"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>-210</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="4d66ddb4-8001-4cd4-9c81-35070a24a7f2" name="Start" type="Start"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-210</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Client ID" stage="Client ID" /><input type="password" name="Client Secret" stage="Client Secret" /><input type="text" name="Resource" stage="Resource" /><input type="text" name="Tenant ID" stage="Tenant ID" /></inputs><onsuccess>55474841-b1c7-42e1-b89d-a9b88b1b632c</onsuccess></stage><stage stageid="2726c2ab-2fd1-48bb-a841-a71e7c22ca73" name="End" type="End"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>150</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Access Token" stage="HTTP Request Result Collection" /></outputs></stage><stage stageid="89720bcd-7a88-43d6-901c-bbcc64be8758" name="Client ID" type="Data"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>-90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="014a60fe-1500-4dbd-828f-ffff07b7cf5b" name="Client Secret" type="Data"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>-60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="f9499e20-d87c-424d-9494-ea104426bbf6" name="Resource" type="Data"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>-30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="08cb2aeb-c7ea-4fc2-b002-5bb670375b77" name="Page Inputs" type="Block"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>-150</displayy><displaywidth>150</displaywidth><displayheight>150</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF00" /></stage><stage stageid="fd51f8cf-29af-476d-8c66-cd3ca07f4656" name="Get Token" type="Action"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><loginhibitparameters /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[AzureAD - Oauth Base URL]&amp; [Tenant ID] &amp; &quot;/oauth2/token&quot;" /><input type="text" name="Body" narrative="The body text of the HTTP request" expr="[Request Body]" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="False" /><input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/x-www-form-urlencoded&quot;" /><input type="text" name="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="&quot;&quot;" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="&quot;&quot;" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="&quot;&quot;" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" expr="" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="&quot;application/json&quot;" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="&quot;&quot;" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="&quot;&quot;" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="&quot;&quot;" /><input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="False" /></inputs><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Http Request Result JSON" /><output type="text" name="statusCode" stage="Http Request Status Code" /></outputs><onsuccess>5ca0d9ee-7951-40fa-9f37-ecd43507cc1c</onsuccess><resource object="Utility - HTTP (Extended)" action="HTTP Request - with Status Code" /></stage><stage stageid="302acc6e-27e3-46c6-94e5-470588167624" name="Tenant ID" type="Data"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>-120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="737c4c1d-c715-4295-8e6c-9861e7e8d3d9" name="Generate Request Body" type="Calculation"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>fd51f8cf-29af-476d-8c66-cd3ca07f4656</onsuccess><calculation expression="&quot;client_id=&quot;&amp;[Client ID]&amp;&#xA;&quot;&amp;client_secret=&quot;&amp;[Client Secret URL Encoded]&amp;&#xA;&quot;&amp;resource=&quot;&amp;[Resource]&amp;&#xA;&quot;&amp;grant_type=client_credentials&quot;&#xA;" stage="Request Body" /></stage><stage stageid="d3d38e2b-372f-4c6e-aaed-ef8e51bfb7b7" name="Request Body" type="Data"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dcc929a7-be1f-435e-a06e-8091db52600d" name="Page Data" type="Block"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>180</displayheight><font family="Segoe UI" size="10" style="Regular" color="00FFFF" /></stage><stage stageid="38cc5d76-7c2e-4ef8-bff1-8a5f5366f200" name="Http Request Result JSON" type="Data"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="37d5ef59-6f2c-4efc-bd73-6c186af96cc3" name="Http Request Status Code" type="Data"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>150</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="580dea7d-fa9f-41f1-b8c6-a5ce7e9c3ade" name="URL Encode Client Secret" type="Action"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><loginhibitparameters /><narrative></narrative><displayx>15</displayx><displayy>-120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="URL" narrative="The URL to encode" expr="[Client Secret]" /></inputs><outputs><output type="text" name="URL" narrative="The encoded URL" stage="Client Secret URL Encoded" /></outputs><onsuccess>49ec70f6-8242-412d-8fe0-3930e6215600</onsuccess><resource object="Utility - Http (Version 6)" action="URL Encode" /></stage><stage stageid="2df6253a-f4d9-4020-871c-117690bb86f5" name="Client Secret URL Encoded" type="Data"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>210</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="5ca0d9ee-7951-40fa-9f37-ecd43507cc1c" name="Success?" type="Decision"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>60</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Http Request Status Code] = &quot;200&quot;" /><ontrue>31389e9b-83a9-4fef-a7ab-592dd3798c7b</ontrue><onfalse>29232abc-c853-4aef-a677-1cf1bd0dedf4</onfalse></stage><stage stageid="31389e9b-83a9-4fef-a7ab-592dd3798c7b" name="Convert JSON Result to Collection" type="Action"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="json" expr="[Http Request Result JSON]" /></inputs><outputs><output type="collection" name="Result" stage="HTTP Request Result Collection" /></outputs><onsuccess>2726c2ab-2fd1-48bb-a841-a71e7c22ca73</onsuccess><resource object="Utility - JSON" action="JSON to Collection" /></stage><stage stageid="7e09ff98-0e40-424b-bb96-5db751964fa0" name="HTTP Request Result Collection" type="Collection"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>315</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="f269917d-8590-4f26-89a2-f92835005f74" name="Page Outputs" type="Block"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>285</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="00FF00" /></stage><stage stageid="29232abc-c853-4aef-a677-1cf1bd0dedf4" name="System Exception" type="Exception"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>105</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><exception type="System Excepion" detail="[Http Request Status Code] &amp; &quot; | &quot; &amp; [HTTP Request Result Collection.error] &amp; &quot; | &quot; &amp; [HTTP Request Result Collection.error_description]" /></stage><stage stageid="49ec70f6-8242-412d-8fe0-3930e6215600" name="Generate URL" type="Calculation"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>737c4c1d-c715-4295-8e6c-9861e7e8d3d9</onsuccess><calculation expression="&quot;https://login.microsoftonline.com/&quot;&amp;[Tenant ID]&amp;&quot;/oauth2/token&quot;" stage="Request URL" /></stage><stage stageid="09eb1c6c-6106-491b-8936-f341ae6bd572" name="Request URL" type="Data"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>240</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="55474841-b1c7-42e1-b89d-a9b88b1b632c" name="All Inputs Provided?" type="Decision"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-165</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="Trim([Client ID]) &lt;&gt; &quot;&quot; AND&#xA;Trim([Tenant ID]) &lt;&gt; &quot;&quot; AND&#xA;Trim([Client Secret]) &lt;&gt; &quot;&quot; AND&#xA;Trim([Resource]) &lt;&gt; &quot;&quot;" /><ontrue>580dea7d-fa9f-41f1-b8c6-a5ce7e9c3ade</ontrue><onfalse>363152ee-9703-44df-9513-d095d74da003</onfalse></stage><stage stageid="363152ee-9703-44df-9513-d095d74da003" name="System Exception" type="Exception"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>105</displayx><displayy>-165</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><exception type="System Exception" detail="&quot;You must provide All Inputs&quot;" /></stage><stage stageid="cbbfb03e-9d9a-4700-885a-63a6811107df" name="Get Bearer Token" type="SubSheetInfo"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="0c01ef72-d79a-4ad1-b443-9e46eba1e7f4" name="Start" type="Start"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credential Name" stage="Credential Name" /></inputs><onsuccess>7a8fb905-8546-4084-867a-46541c621340</onsuccess></stage><stage stageid="13832b65-b3d3-4f8d-b9ea-619d907080fc" name="End" type="End"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>165</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="password" name="Token" stage="Token" /></outputs></stage><stage stageid="6f0effd1-c049-48b6-98a1-0f6e46e0b55d" name="Page Inputs" type="Block"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF00" /></stage><stage stageid="125e611f-9ef8-453f-9734-4f139d292fdb" name="ClientID" type="Data"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="3e6c8539-e8d1-4ddd-b110-242511188707" name="Resource" type="Data"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="b5828ebc-a646-4f3c-a66d-16ab62c5405a" name="TenantID" type="Data"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="4b0138b6-a0f4-46ce-bbcc-2f5824c175b0" name="Secret" type="Data"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>150</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="da1526dd-1012-4fd1-b2b7-f7489d500876" name="Page Data" type="Block"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>210</displayheight><font family="Segoe UI" size="10" style="Regular" color="00FFFF" /></stage><stage stageid="cba80b0e-af88-4460-9606-69c232f66c7b" name="ExpiryDateTime" type="Data"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="90b023f5-3906-4d9e-9e69-3277342bacad" name="Expiry Blank?" type="Decision"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="Trim([ExpiryDateTime]) = &quot;&quot;" /><ontrue>578a81cb-5946-463f-8b66-2772127d7b6e</ontrue><onfalse>6c21a78c-0477-4840-8a84-91ab1add6f2f</onfalse></stage><stage stageid="0f914c51-9fd8-42d3-a14a-e73b3f5adc9d" name="Request Bearer Token (v1 Endpoint)" type="SubSheet"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>120</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Client ID" expr="[ClientID]" /><input type="password" name="Client Secret" expr="[Secret]" /><input type="text" name="Resource" expr="[Resource]" /><input type="text" name="Tenant ID" expr="[TenantID]" /></inputs><outputs><output type="collection" name="Access Token" stage="Access Token" /></outputs><onsuccess>acefd407-0b7d-4075-89fc-b58ee907bea6</onsuccess><processid>1ab47c92-5133-4d61-a56e-ea9111cc2626</processid></stage><stage stageid="6c21a78c-0477-4840-8a84-91ab1add6f2f" name="Valid?" type="Decision"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative>+MakeTimeSpan(0, 1, 10, 0)</narrative><displayx>15</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="ToDateTime(Upper([ExpiryDateTime]))- MakeTimeSpan(0, 0, 10, 0) &gt;  (Now())" /><ontrue>a6757922-aa41-4312-9fa2-579f7d1ed0b9</ontrue><onfalse>0f914c51-9fd8-42d3-a14a-e73b3f5adc9d</onfalse></stage><stage stageid="578a81cb-5946-463f-8b66-2772127d7b6e" name="Anchor1" type="Anchor"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>120</displayx><displayy>30</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>0f914c51-9fd8-42d3-a14a-e73b3f5adc9d</onsuccess></stage><stage stageid="a6757922-aa41-4312-9fa2-579f7d1ed0b9" name="Get Access Token from Vault" type="Action"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials" expr="[Credential Name]" /><input type="text" name="Property Name" narrative="The name of the property" expr="&quot;Token&quot;" /></inputs><outputs><output type="password" name="Property Value" narrative="The value of the property" stage="Token" /></outputs><onsuccess>13832b65-b3d3-4f8d-b9ea-619d907080fc</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get Property" /></stage><stage stageid="0949796b-4792-4fa8-99f2-34ed8f531a23" name="Save Token to Vault" type="SubSheetInfo"><subsheetid>ba330b98-d2a0-4be7-a290-2f8e32f0f236</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>-75</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="9558e056-5c4c-46ff-aefa-0e414776e60b" name="Start" type="Start"><subsheetid>ba330b98-d2a0-4be7-a290-2f8e32f0f236</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="password" name="Expiry DateTime" stage="Expiry DateTime" /><input type="password" name="Token" stage="Token" /><input type="text" name="Credential Name" stage="Credential Name" /></inputs><onsuccess>5531d4c7-776a-4a09-8a21-04c020ca847c</onsuccess></stage><stage stageid="9e5e7159-c34a-4c48-ae46-b1a043597be9" name="End" type="End"><subsheetid>ba330b98-d2a0-4be7-a290-2f8e32f0f236</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="6b318086-7d0c-4a71-9a4d-deca2055124d" name="Expiry DateTime" type="Data"><subsheetid>ba330b98-d2a0-4be7-a290-2f8e32f0f236</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="0929f682-3338-45fd-8096-43512952734c" name="Token" type="Data"><subsheetid>ba330b98-d2a0-4be7-a290-2f8e32f0f236</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="05d96789-f9bf-4ef8-83cc-78ff17553131" name="Page Inputs" type="Block"><subsheetid>ba330b98-d2a0-4be7-a290-2f8e32f0f236</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF00" /></stage><stage stageid="5531d4c7-776a-4a09-8a21-04c020ca847c" name="Set Expiry DateTime" type="Action"><subsheetid>ba330b98-d2a0-4be7-a290-2f8e32f0f236</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-60</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials" expr="[Credential Name]" /><input type="text" name="Property Name" narrative="The name of the property" expr="&quot;ExpiryDateTime&quot;" /><input type="password" name="Property Value" narrative="The value of the property" expr="[Expiry DateTime]" /></inputs><onsuccess>ef112e40-46a5-4143-b679-99c3218e67e2</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Set Property" /></stage><stage stageid="ef112e40-46a5-4143-b679-99c3218e67e2" name="Set Token in Vault" type="Action"><subsheetid>ba330b98-d2a0-4be7-a290-2f8e32f0f236</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials" expr="[Credential Name]" /><input type="text" name="Property Name" narrative="The name of the property" expr="&quot;Token&quot;" /><input type="password" name="Property Value" narrative="The value of the property" expr="[Token]" /></inputs><onsuccess>9e5e7159-c34a-4c48-ae46-b1a043597be9</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Set Property" /></stage><stage stageid="333c09d3-b19a-426c-9c4a-59a9c11d6bd2" name="Save Token to Vault" type="SubSheet"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>120</displayx><displayy>165</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="password" name="Expiry DateTime" expr="Upper(ToDateTime(&quot;01/01/1970&quot;) + MakeTimeSpan(0,0,0, [Access Token.expires_on]))" /><input type="password" name="Token" expr="[Token]" /><input type="text" name="Credential Name" expr="[Credential Name]" /></inputs><onsuccess>e48c26fd-2861-4384-a23a-f0d4fade3874</onsuccess><processid>ba330b98-d2a0-4be7-a290-2f8e32f0f236</processid></stage><stage stageid="6e294dfc-d2ea-46a5-b7a5-ad4db4d71a56" name="Access Token" type="Collection"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>210</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="2db13526-ae43-4cbe-a1f2-9ebd9205a2fa" name="Token" type="Data"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>285</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="392a47d8-e052-4c95-b4ab-58e6003b1630" name="Page Outputs" type="Block"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>255</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="00FF00" /></stage><stage stageid="e48c26fd-2861-4384-a23a-f0d4fade3874" name="End2" type="End"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>120</displayx><displayy>225</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="password" name="Token" stage="Token" /></outputs></stage><stage stageid="9eaedc38-36fe-4071-9dce-cc4e83916c39" name="Credential Name" type="Data"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">AzureAD - FraudTracker</initialvalue><private /><alwaysinit /></stage><stage stageid="c64b465b-6957-4d86-9660-f463b3f70317" name="Get Details from Vault" type="SubSheetInfo"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="db964fa6-6e2d-4dde-8b6d-e667afa30aea" name="Start" type="Start"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credential Name" stage="Credential Name" /></inputs><onsuccess>7de5135f-b443-4d7d-b986-5e8ad2c9b0c7</onsuccess></stage><stage stageid="20c67c06-3a10-4d55-a5fb-8abb7c669d75" name="End" type="End"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>345</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="password" name="ClientID" stage="ClientID" /><output type="password" name="Resource" stage="Resource" /><output type="password" name="ExpiryDateTime" stage="ExpiryDateTime" /><output type="password" name="Secret" stage="Secret" /><output type="password" name="TenantID" stage="TenantID" /></outputs></stage><stage stageid="7de5135f-b443-4d7d-b986-5e8ad2c9b0c7" name="Get ClientID" type="Action"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-60</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials" expr="[Credential Name]" /><input type="text" name="Property Name" narrative="The name of the property" expr="&quot;ClientID&quot;" /></inputs><outputs><output type="password" name="Property Value" narrative="The value of the property" stage="ClientID" /></outputs><onsuccess>9a829eb2-5d90-47bb-b323-bb5babfb8afd</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get Property" /></stage><stage stageid="f12c4c53-6966-4817-9272-176f36a53ec9" name="Credential Name" type="Data"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8dee64f0-f9b4-4619-ac58-c38a238cefef" name="Page Inputs" type="Block"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-270</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="FFFF00" /></stage><stage stageid="c17e61ee-2437-44ec-9951-0264c6ec7238" name="ClientID" type="Data"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="df85154a-d952-4e1b-95f4-dc3956c3fd48" name="Page Outputs" type="Block"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-270</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>180</displayheight><font family="Segoe UI" size="10" style="Regular" color="00FF00" /></stage><stage stageid="9a829eb2-5d90-47bb-b323-bb5babfb8afd" name="Client ID Blank?" type="Decision"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="Trim([ClientID]) = &quot;&quot;" /><ontrue>445b1703-6bf8-4c6e-a805-1dc40522dfec</ontrue><onfalse>37230e96-6745-42ac-a344-f0302a573599</onfalse></stage><stage stageid="445b1703-6bf8-4c6e-a805-1dc40522dfec" name="Credential Exception" type="Exception"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>135</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><exception type="Credential Exception" detail="&quot;ClientID is blank for credential &quot; &amp;[Credential Name]" /></stage><stage stageid="3e32c74e-8b80-4d35-bc0d-bd72fee5d9d6" name="ExpiryDateTime" type="Action"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>300</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials" expr="[Credential Name]" /><input type="text" name="Property Name" narrative="The name of the property" expr="&quot;ExpiryDateTime&quot;" /></inputs><outputs><output type="password" name="Property Value" narrative="The value of the property" stage="ExpiryDateTime" /></outputs><onsuccess>20c67c06-3a10-4d55-a5fb-8abb7c669d75</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get Property" /></stage><stage stageid="4c60fe38-d6dd-45da-8aab-b0b586f45fdd" name="ExpiryDateTime" type="Data"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>150</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="37230e96-6745-42ac-a344-f0302a573599" name="Get Resource" type="Action"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials" expr="[Credential Name]" /><input type="text" name="Property Name" narrative="The name of the property" expr="&quot;Resource&quot;" /></inputs><outputs><output type="password" name="Property Value" narrative="The value of the property" stage="Resource" /></outputs><onsuccess>d7e622d2-d1fb-4695-84da-13b276ae5658</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get Property" /></stage><stage stageid="933fa8ec-97bc-483d-b4fb-38c1dc5523e0" name="Resource" type="Data"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="d7e622d2-d1fb-4695-84da-13b276ae5658" name="Resource Blank?" type="Decision"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="Trim([Resource]) = &quot;&quot;" /><ontrue>81002925-dfe8-466c-8e8a-643674a542a6</ontrue><onfalse>bd1839d7-b055-4e3f-aa1c-ef56d76a27a2</onfalse></stage><stage stageid="81002925-dfe8-466c-8e8a-643674a542a6" name="Credential Exception" type="Exception"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>135</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><exception type="Credential Exception" detail="&quot;Resource is blank for credential &quot; &amp;[Credential Name]" /></stage><stage stageid="bd1839d7-b055-4e3f-aa1c-ef56d76a27a2" name="Get Secret" type="Action"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials" expr="[Credential Name]" /><input type="text" name="Property Name" narrative="The name of the property" expr="&quot;Secret&quot;" /></inputs><outputs><output type="password" name="Property Value" narrative="The value of the property" stage="Secret" /></outputs><onsuccess>0c228d8b-ad9c-476d-9ad9-9561ed926be8</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get Property" /></stage><stage stageid="0c228d8b-ad9c-476d-9ad9-9561ed926be8" name="Secret Blank?" type="Decision"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>165</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="Trim([Secret]) = &quot;&quot;" /><ontrue>69f6a0db-1385-4b73-96ff-1079a6080be8</ontrue><onfalse>a87514d8-d69b-4c6e-8b1d-be66a7f1cd89</onfalse></stage><stage stageid="69f6a0db-1385-4b73-96ff-1079a6080be8" name="Credential Exception" type="Exception"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>135</displayx><displayy>165</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><exception type="Credential Exception" detail="&quot;Secret is blank for credential &quot; &amp;[Secret]" /></stage><stage stageid="df2d2195-6f4b-4bbf-b9cd-a938db0cb23d" name="Secret" type="Data"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="7a8fb905-8546-4084-867a-46541c621340" name="Get Details from Vault" type="SubSheet"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credential Name" expr="[Credential Name]" /></inputs><outputs><output type="password" name="ClientID" stage="ClientID" /><output type="password" name="Resource" stage="Resource" /><output type="password" name="ExpiryDateTime" stage="ExpiryDateTime" /><output type="password" name="Secret" stage="Secret" /><output type="password" name="TenantID" stage="TenantID" /></outputs><onsuccess>90b023f5-3906-4d9e-9e69-3277342bacad</onsuccess><processid>310f0735-7466-44a2-923e-0997e4a8320c</processid></stage><stage stageid="a87514d8-d69b-4c6e-8b1d-be66a7f1cd89" name="Get TenantID" type="Action"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>210</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Credentials Name" narrative="The name of the credentials" expr="[Credential Name]" /><input type="text" name="Property Name" narrative="The name of the property" expr="&quot;TenantID&quot;" /></inputs><outputs><output type="password" name="Property Value" narrative="The value of the property" stage="TenantID" /></outputs><onsuccess>f8b472c1-2f6c-44a2-8045-d8b180849b08</onsuccess><resource object="Blueprism.Automate.clsCredentialsActions" action="Get Property" /></stage><stage stageid="f8b472c1-2f6c-44a2-8045-d8b180849b08" name="TenantID Blank?" type="Decision"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>15</displayx><displayy>255</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="Trim([TenantID]) = &quot;&quot;" /><ontrue>ea4123f5-3cac-4244-9f8e-9608004b49f5</ontrue><onfalse>3e32c74e-8b80-4d35-bc0d-bd72fee5d9d6</onfalse></stage><stage stageid="ea4123f5-3cac-4244-9f8e-9608004b49f5" name="Credential Exception" type="Exception"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>135</displayx><displayy>255</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><exception type="Credential Exception" detail="&quot;TenantID is blank for credential &quot; &amp;[Secret]" /></stage><stage stageid="fb35d274-ffe1-48ee-b1f4-982e32d58d1b" name="TenantID" type="Data"><subsheetid>310f0735-7466-44a2-923e-0997e4a8320c</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="9d220186-7fd3-46bf-9d28-dcf4b691f1c5" name="Credential Name" type="Data"><subsheetid>ba330b98-d2a0-4be7-a290-2f8e32f0f236</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="339b73ff-a49b-4b70-ac0d-9357627f6e7a" name="AzureAD - Oauth Base URL" type="Data"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-120</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><exposure>Environment</exposure><private /><alwaysinit /></stage><stage stageid="9cd8fe06-e059-47e0-8b6b-d8f701d8fe72" name="Environment Variables" type="Block"><subsheetid>1ab47c92-5133-4d61-a56e-ea9111cc2626</subsheetid><loginhibit onsuccess="true" /><narrative></narrative><displayx>-195</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="FF00FF" /></stage><stage stageid="acefd407-0b7d-4075-89fc-b58ee907bea6" name="Save Token" type="Calculation"><subsheetid>798c3018-2b3f-494a-a536-d1b2b7fd15ec</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>333c09d3-b19a-426c-9c4a-59a9c11d6bd2</onsuccess><calculation expression="&quot;Bearer &quot; &amp; [Access Token.access_token]" stage="Token" /></stage></process></object>
        <object id="07907aae-4208-4670-8fd3-61b7abb63671" name="Utility - HTTP (Extended)" xmlns="http://www.blueprism.co.uk/product/process"><process name="Utility - HTTP (Extended)" version="5.0.32" bpversion="6.4.3.13244" narrative="Communicates with web services using the HTTP protocol." byrefcollection="true" type="object" runmode="Exclusive"><appdef><element name="Application Root"><id>2ba17e26-49eb-43ed-84dd-c40e67e990b0</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="925e0261-2b2e-41ed-b555-4c5ccf8a00fc" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="f3a55ad6-3bfa-4401-baa9-0e50afe42879" type="Normal" published="True"><name>Post</name><view><camerax>109</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ecff5a78-99b1-4ecb-a356-a075c487ef71" type="Normal" published="True"><name>Post JSON</name><view><camerax>239</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d30e8f45-db72-40d2-9f17-9700006fe152" type="Normal" published="True"><name>HTTP Request</name><view><camerax>50</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="519a0dc7-b254-478b-b2ed-c7883124e31b" type="Normal" published="True"><name>Load Certificate</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="037d71ae-94af-4152-9ed2-893f3daa7477" type="Normal" published="True"><name>HTTP Request - with Status Code</name><view><camerax>50</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="bee831af-f964-4218-87f3-d3378e2eab10" name="Start" type="Start"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>071f13b7-de3d-4625-9498-9da634d452b4</onsuccess></stage><stage stageid="11e111be-101c-4df7-9d5c-910a10c02e2d" name="End" type="End"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="9c4d6f4e-1d32-4d1f-a37d-f279b42fa480" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><references><reference>System.Data.dll</reference><reference>System.Web.dll</reference><reference>System.Xml.dll</reference></references><imports><import>System</import><import>System.Net</import><import>System.Data</import><import>System.Security.Cryptography.X509Certificates</import><import>System.Collections.Generic</import></imports><language>visualbasic</language><globalcode><![CDATA[

]]></globalcode><code><![CDATA[Private m_Certificates As New Dictionary(Of String, X509Certificate2)

Private Function GetCertificate(ByVal subject As String) As X509Certificate2
	Dim store As New X509Store(StoreName.My, StoreLocation.LocalMachine)
	Try
		store.Open(OpenFlags.ReadOnly)
		Dim certs As X509Certificate2Collection = store.Certificates.Find(X509FindType.FindBySubjectName, subject, True)
		For Each cert As X509Certificate2 In certs
			Return cert
		Next
	Finally
		store.Close()
	End Try
	Return Nothing
End Function]]></code></stage><stage stageid="b48af877-43b3-4056-b8b4-88bac82a5c80" name="Clean Up" type="SubSheetInfo"><subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="d35cb9b6-000c-45e5-9a29-9001404a21d0" name="Start" type="Start"><subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>f1054fe8-46c8-42ab-b236-5b07592ec5eb</onsuccess></stage><stage stageid="f1054fe8-46c8-42ab-b236-5b07592ec5eb" name="End" type="End"><subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ab202953-451b-4e7c-8cd5-c050e06e286a" name="Post" type="SubSheetInfo"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative>Sends a message to HTTP endpoint using the POST method. The collection data is encoded using "application/x-www-form-urlencoded"</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="e2777b38-8eba-4a04-a611-28bcd6c4add6" name="Start" type="Start"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP Post data to" stage="Address URL" /><input type="collection" name="Post Data" narrative="A collection of values to send as Post data" stage="Post Data" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" /><input type="collection" name="Headers" narrative="OPTIONAL: HTTP Headers" stage="Headers" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" stage="Accept" /></inputs><onsuccess>e42b0caa-40c1-4a89-a873-f6977581053b</onsuccess></stage><stage stageid="f51a79a9-1213-484c-bedc-065f44051a02" name="End" type="End"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /></outputs></stage><stage stageid="14154308-012d-47e4-a707-8ca80b73651e" name="new" type="Note"><subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="4228ae7a-9bb3-4de4-9bbf-00e32d925ecf" name="new" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="e42b0caa-40c1-4a89-a873-f6977581053b" name="Get Body" type="Code"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="postData" expr="[Post Data]" /></inputs><outputs><output type="text" name="body" stage="Body" /></outputs><onsuccess>e9085eba-5f15-4b65-91ed-41abf7c6917f</onsuccess><code><![CDATA[Dim sb As New System.Text.StringBuilder
For Each r As DataRow In postData.Rows
	Dim first As Boolean = True
	For Each c As DataColumn In postData.Columns
		If first Then
			first = False
		Else
			sb.Append("&")
		End If
		Dim columnName As String = c.ColumnName
		Dim encodedCol As String = System.Web.HttpUtility.UrlEncode(columnName)
		sb.Append(encodedCol)
		sb.Append("=")
		Dim val As String = r(columnName).ToString
		Dim encodedVal As String = System.Web.HttpUtility.UrlEncode(val)
		sb.Append(encodedVal)
	Next
	Exit For 'Only one row is allowed
Next

body=sb.ToString()
]]></code></stage><stage stageid="1c58d0fb-9a9b-4d2f-861f-5c22ab835c31" name="Result" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>90</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b98abed4-9669-476c-87d9-3f485683d049" name="Address URL" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f4c2a5eb-36de-4904-a963-a8513b7e8840" name="Post Data" type="Collection"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>150</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="071f13b7-de3d-4625-9498-9da634d452b4" name="Setup" type="Code"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-60</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>ffb0cc88-94e9-4ad0-8bc5-9735666577c6</onsuccess><code><![CDATA[System.Net.ServicePointManager.Expect100Continue = False]]></code></stage><stage stageid="f6ed43b3-714e-4161-b44b-b60490592281" name="Proxy Password" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>405</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="bcedbed1-3ed7-42d7-8f16-7e2071c3e187" name="Proxy Username" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>345</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="66afe5b7-37e4-4ed7-a9fc-a78e1ab8890c" name="Proxy URL" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>285</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="be7856fe-4027-4226-8caa-851bb6e7df21" name="Use Proxy" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>225</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="38c313e6-bc0d-49e5-a6ab-4042a0682d3d" name="Post JSON" type="SubSheetInfo"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative>Sends a message to HTTP endpoint using the POST method. The action expects a raw string and sets the content type to "application/json"</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="37166627-b66b-4a9c-a321-539933de2123" name="End" type="End"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /></outputs></stage><stage stageid="878a70a1-d658-4563-b27c-245f947b74be" name="Result" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>90</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6875cda6-dbbe-47b6-ab82-b62f89c90a88" name="JSON" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>150</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4956e14f-001c-4406-a401-38c63ff06696" name="Start" type="Start"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP Post data to" stage="Address URL" /><input type="text" name="JSON" narrative="The JSON to send" stage="JSON" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" /></inputs><onsuccess>6b571f09-555c-45a8-9475-957d41cafb24</onsuccess></stage><stage stageid="696696c8-af04-4075-aea0-a8024e2431fe" name="Address URL" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="582df200-7287-4dc1-a9a2-6c9e09276f77" name="Proxy Password" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>405</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="924eb1dd-b782-4f71-82b6-9923ea0093ec" name="Proxy Username" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>345</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ed09a5ed-6c7b-4dd3-9bf0-8df61da66ea3" name="Proxy URL" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>285</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5e35c8d6-3f97-4ae4-8566-35fb0981e145" name="Use Proxy" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>225</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4a9fcaf1-4310-45cb-a775-ebfadc75ac8a" name="Headers" type="Collection"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>465</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="9e64259d-1a91-444b-8620-b8cd186832d1" name="Accept" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>525</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="58e7a470-3ec3-4033-bb19-0fee1bdcaaed" name="HTTP Request" type="SubSheetInfo"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative>Sends a message to HTTP endpoint using the specified HTTP method and content-type</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="d0a11dcd-f002-46b5-aff6-1026c3be2da8" name="End" type="End"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /></outputs></stage><stage stageid="1fa7def4-c6a8-4325-9bc8-2c6027c0b8e8" name="HTTP Request" type="Code"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="addressURL" expr="[Address URL]" /><input type="text" name="body" expr="[Body]" /><input type="text" name="contentType" expr="[Content Type]" /><input type="text" name="method" expr="[Method]" /><input type="text" name="proxyURL" expr="[Proxy URL]" /><input type="flag" name="useProxy" expr="[Use Proxy]" /><input type="text" name="proxyUsername" expr="[Proxy Username]" /><input type="password" name="proxyPassword" expr="[Proxy Password]" /><input type="collection" name="headers" expr="[Headers]" /><input type="text" name="accept" expr="[Accept]" /><input type="text" name="username" expr="[Username]" /><input type="password" name="password" expr="[Password]" /><input type="text" name="certID" expr="[Certificate ID]" /><input type="flag" name="forcePreAuth" expr="[Force Pre Authorization]" /></inputs><outputs><output type="text" name="resultData" stage="Result" /></outputs><onsuccess>d0a11dcd-f002-46b5-aff6-1026c3be2da8</onsuccess><code><![CDATA[Dim request As WebRequest = WebRequest.Create(addressURL)

If forcePreAuth Then
   'Sometimes a web server will require the authorisation header in the initial request
   'In which case we have to add the basic authorization header manually.
   Dim bytes() As Byte = System.Text.Encoding.UTF8.GetBytes(String.Format("{0}:{1}",username,password))
   Dim base64 As String = Convert.ToBase64String(bytes)
   request.Headers.Add("Authorization", "Basic " & base64)
Else
  If Not String.IsNullOrEmpty(username) AndAlso Not String.IsNullOrEmpty(password) Then
    request.Credentials = New NetworkCredential(username,password)
  End If
End If

If useProxy Then
	Dim proxyURI As New Uri(proxyURL)
	Dim proxy As New WebProxy(proxyURI, True)
	Dim proxyCred As New NetworkCredential(proxyUsername, proxyPassword)
	Dim credCache As New CredentialCache()
	credCache.Add(proxyURI, "Basic", proxyCred)
	proxy.UseDefaultCredentials = False
	proxy.Credentials = credCache
	request.Proxy = proxy
End If

request.Method = method
request.ContentType = contentType

Dim httpRequest As HttpWebRequest = TryCast(request, HttpWebRequest)
If httpRequest IsNot Nothing Then
  If Not String.IsNullOrEmpty(accept) Then
	httpRequest.Accept = accept
  End If
  If Not String.IsNullOrEmpty(certID) Then
    httpRequest.ClientCertificates.Add(m_Certificates(certID))
  End If
End If

For Each r As DataRow In headers.Rows
	For Each c As DataColumn In headers.Columns
		Dim columnName As String = c.ColumnName
		Dim val As String = r(columnName).ToString
		request.Headers.Add(columnName,val)
	Next
	Exit For 'Only one row is allowed
Next

If Not String.IsNullOrEmpty(body) Then
  Dim requestStream As IO.Stream = request.GetRequestStream()
  Using sw As New IO.StreamWriter(requestStream, New Text.UTF8Encoding(False))
    sw.Write(body)
  End Using
End If

Using response As WebResponse = request.GetResponse()
  Dim responseStream As IO.Stream = response.GetResponseStream()
  Dim sr As New IO.StreamReader(responseStream)
  resultData = sr.ReadToEnd()
End Using]]></code></stage><stage stageid="96e2df5a-429a-4030-9565-b8cbbf7be6b3" name="Result" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>75</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8f28cc4e-4ae2-4b01-ad23-0b632027d627" name="Body" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>135</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e305dce1-1fd7-459b-8211-27c26350676d" name="Block1" type="Block"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>-75</displayx><displayy>-105</displayy><displaywidth>285</displaywidth><displayheight>135</displayheight><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="0e0138a9-ccaa-44b1-b742-ad843c39aca1" name="Recover1" type="Recover"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>165</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0645751f-e202-459a-b704-5fb0e0cbebe7</onsuccess></stage><stage stageid="0645751f-e202-459a-b704-5fb0e0cbebe7" name="Exception1" type="Exception"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>270</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="" detail="" usecurrent="yes" /></stage><stage stageid="d8c39895-52d1-45ad-8cd0-be309896d0e5" name="Start" type="Start"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" stage="Address URL" /><input type="text" name="Body" narrative="The body text of the HTTP request" stage="Body" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" /><input type="text" name="Content Type" narrative="The content type of the HTTP request." stage="Content Type" /><input type="text" name="Method" narrative="The method of the HTTP request." stage="Method" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" stage="Headers" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" stage="Accept" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" stage="Username" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" stage="Password" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" stage="Certificate ID" /><input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" stage="Force Pre Authorization" /></inputs><onsuccess>1fa7def4-c6a8-4325-9bc8-2c6027c0b8e8</onsuccess></stage><stage stageid="c4e87c4e-8150-4a15-8fc5-ddc736b949ae" name="Address URL" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>75</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="038a7411-25dc-456c-8007-bb82f3d94de7" name="Proxy Password" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>255</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="8ef02e3a-8214-4163-b44d-a5081ed8b9e4" name="Proxy Username" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>195</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1c6f3a8d-428e-4a61-815c-f32a8a117ae3" name="Proxy URL" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>135</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5c4cc5f6-0531-4375-b9c1-3fcb529dde9b" name="Use Proxy" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>75</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4a98d0d5-c3b8-42fb-933f-2168265f12d6" name="Content Type" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>195</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fc9f21c4-39ba-4135-8356-f9a516bf6b99" name="Method" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>255</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6b571f09-555c-45a8-9475-957d41cafb24" name="HTTP Request" type="SubSheet"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[Address URL]" /><input type="text" name="Body" narrative="The body text of the HTTP request" expr="[JSON]" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="[Use Proxy]" /><input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/json&quot;" /><input type="text" name="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="[Proxy URL]" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="[Proxy Username]" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="[Proxy Password]" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /></inputs><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /></outputs><onsuccess>37166627-b66b-4a9c-a321-539933de2123</onsuccess><processid>d30e8f45-db72-40d2-9f17-9700006fe152</processid></stage><stage stageid="33b3447c-a55e-4af3-be35-6cb5624d6a4f" name="Headers" type="Collection"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>315</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="ac16a164-f018-4111-949f-3db9d4d873d9" name="Accept" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>375</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="23c8dd77-277a-4aac-8df7-31c951626abd" name="Body" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e9085eba-5f15-4b65-91ed-41abf7c6917f" name="HTTP Request" type="SubSheet"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[Address URL]" /><input type="text" name="Body" narrative="The body text of the HTTP request" expr="[Body]" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="[Use Proxy]" /><input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/x-www-form-urlencoded&quot;" /><input type="text" name="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="[Proxy URL]" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="[Proxy Username]" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="[Proxy Password]" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" expr="[Headers]" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="[Accept]" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /></inputs><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /></outputs><onsuccess>f51a79a9-1213-484c-bedc-065f44051a02</onsuccess><processid>d30e8f45-db72-40d2-9f17-9700006fe152</processid></stage><stage stageid="4bd01e67-49a4-4082-be0d-df1bb9cecb13" name="Username" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>315</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dac70b0c-83cb-4605-8f7b-d1d8d21922d3" name="Password" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>375</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="9091a189-b87b-4ed7-9747-1e1e9fe657f6" name="Load Certificate" type="SubSheetInfo"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="3cff8803-c15f-4ab4-a032-d0afb9fa20ae" name="Start" type="Start"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Filename" narrative="OPTIONAL: The full path to a file containing the certificate" stage="Filename" /><input type="text" name="Subject" narrative="OPTIONAL: The subject of the certificate if loading from the store" stage="Subject" /><input type="password" name="Password" narrative="OPTIONAL: The password to load the certificate if needed" stage="Password" /></inputs><onsuccess>8962b858-f6e2-413c-9ceb-3d80dee88de2</onsuccess></stage><stage stageid="17fddf56-07f2-4942-8515-e1b183458a7f" name="End" type="End"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Certificate ID" narrative="The ID of the certificate" stage="Certificate ID" /></outputs></stage><stage stageid="e9b8de2b-8e54-4772-b186-046ca262c94c" name="Filename" type="Data"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5f0ec822-a1c0-4b6b-91ba-739b0b2762b8" name="Subject" type="Data"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><narrative></narrative><displayx>150</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8962b858-f6e2-413c-9ceb-3d80dee88de2" name="Load" type="Code"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="filename" expr="[Filename]" /><input type="password" name="password" expr="[Password]" /><input type="text" name="subject" expr="[Subject]" /></inputs><outputs><output type="text" name="thumbprint" stage="Certificate ID" /></outputs><onsuccess>17fddf56-07f2-4942-8515-e1b183458a7f</onsuccess><code><![CDATA[Dim cert As X509Certificate2 = Nothing
If Not String.IsNullOrEmpty(filename) Then
  cert = New X509Certificate2(filename,password)
End If

If Not String.IsNullOrEmpty(subject) Then
  cert=GetCertificate(subject)
End If

thumbprint = cert.Thumbprint
m_Certificates.Add(thumbprint,cert)
]]></code></stage><stage stageid="745e7557-7761-4078-8ff7-334b6873f126" name="Certificate ID" type="Data"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="471ae54f-286f-4472-b48c-114fc7d04bf9" name="Password" type="Data"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><narrative></narrative><displayx>210</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="452476e7-b29f-4e5f-999a-c67789bbb0db" name="Certificate ID" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>435</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5de144f5-aa91-46e0-8f9c-ac8495d2ab0c" name="Force Pre Authorization" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>435</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="628c3479-7f93-43c9-b160-43fd1823d119" name="HTTP Request - with Status Code" type="SubSheetInfo"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative>Sends a message to HTTP endpoint using the specified HTTP method and content-type</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="28a219bb-9b12-47a6-bacc-f693d13a5d90" name="End" type="End"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="statusCode" stage="statusCode" /></outputs></stage><stage stageid="a3ca6ee6-fe87-4b96-8b73-d374ed82c823" name="HTTP Request with Status Code" type="Code"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="addressURL" expr="[Address URL]" /><input type="text" name="body" expr="[Body]" /><input type="text" name="contentType" expr="[Content Type]" /><input type="text" name="method" expr="[Method]" /><input type="text" name="proxyURL" expr="[Proxy URL]" /><input type="flag" name="useProxy" expr="[Use Proxy]" /><input type="text" name="proxyUsername" expr="[Proxy Username]" /><input type="password" name="proxyPassword" expr="[Proxy Password]" /><input type="collection" name="headers" expr="[Headers]" /><input type="text" name="accept" expr="[Accept]" /><input type="text" name="username" expr="[Username]" /><input type="password" name="password" expr="[Password]" /><input type="text" name="certID" expr="[Certificate ID]" /><input type="flag" name="forcePreAuth" expr="[Force Pre Authorization]" /></inputs><outputs><output type="text" name="resultData" stage="Result" /><output type="text" name="statusCode" stage="statusCode" /></outputs><onsuccess>28a219bb-9b12-47a6-bacc-f693d13a5d90</onsuccess><code><![CDATA[Dim request As WebRequest = WebRequest.Create(addressURL)

If forcePreAuth Then
   'Sometimes a web server will require the authorisation header in the initial request
   'In which case we have to add the basic authorization header manually.
   Dim bytes() As Byte = System.Text.Encoding.UTF8.GetBytes(String.Format("{0}:{1}",username,password))
   Dim base64 As String = Convert.ToBase64String(bytes)
   request.Headers.Add("Authorization", "Basic " & base64)
Else
  If Not String.IsNullOrEmpty(username) AndAlso Not String.IsNullOrEmpty(password) Then
    request.Credentials = New NetworkCredential(username,password)
  End If
End If

If useProxy Then
	Dim proxyURI As New Uri(proxyURL)
	Dim proxy As New WebProxy(proxyURI, True)
	Dim proxyCred As New NetworkCredential(proxyUsername, proxyPassword)
	Dim credCache As New CredentialCache()
	credCache.Add(proxyURI, "Basic", proxyCred)
	proxy.UseDefaultCredentials = False
	proxy.Credentials = credCache
	request.Proxy = proxy
End If

request.Method = method
request.ContentType = contentType

Dim httpRequest As HttpWebRequest = TryCast(request, HttpWebRequest)
If httpRequest IsNot Nothing Then
  If Not String.IsNullOrEmpty(accept) Then
	httpRequest.Accept = accept
  End If
  If Not String.IsNullOrEmpty(certID) Then
    httpRequest.ClientCertificates.Add(m_Certificates(certID))
  End If
End If

For Each r As DataRow In headers.Rows
	For Each c As DataColumn In headers.Columns
		Dim columnName As String = c.ColumnName
		Dim val As String = r(columnName).ToString
		request.Headers.Add(columnName,val)
	Next
	Exit For 'Only one row is allowed
Next

If Not String.IsNullOrEmpty(body) Then
  Dim requestStream As IO.Stream = request.GetRequestStream()
  Using sw As New IO.StreamWriter(requestStream, New Text.UTF8Encoding(False))
    sw.Write(body)
  End Using
End If

Using response As HttpWebResponse = request.GetResponse()
  Dim responseStream As IO.Stream = response.GetResponseStream()
  Dim sr As New IO.StreamReader(responseStream)
  resultData = sr.ReadToEnd()
  statusCode = response.StatusCode
End Using]]></code></stage><stage stageid="2d047444-cc95-4671-be4b-d542095a3acc" name="Result" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>75</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f332c4af-8fbd-4f32-9213-1049d70f59b8" name="Body" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>135</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9e51b37c-fe8c-4084-a85d-59795296f523" name="Block1" type="Block"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><loginhibit /><narrative></narrative><displayx>-75</displayx><displayy>-105</displayy><displaywidth>285</displaywidth><displayheight>135</displayheight><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="37c6dd31-3c3b-4217-ad71-111aa12a18b9" name="Recover1" type="Recover"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><loginhibit /><narrative></narrative><displayx>165</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0339929c-33d7-4fe2-be5f-db330a168bd5</onsuccess></stage><stage stageid="0339929c-33d7-4fe2-be5f-db330a168bd5" name="Exception1" type="Exception"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>270</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="" detail="" usecurrent="yes" /></stage><stage stageid="c4dc959b-4a18-4ca8-8d99-04e0ce0fdaff" name="Start" type="Start"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" stage="Address URL" /><input type="text" name="Body" narrative="The body text of the HTTP request" stage="Body" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" /><input type="text" name="Content Type" narrative="The content type of the HTTP request." stage="Content Type" /><input type="text" name="Method" narrative="The method of the HTTP request." stage="Method" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" stage="Headers" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" stage="Accept" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" stage="Username" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" stage="Password" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" stage="Certificate ID" /><input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" stage="Force Pre Authorization" /></inputs><onsuccess>a3ca6ee6-fe87-4b96-8b73-d374ed82c823</onsuccess></stage><stage stageid="423f500a-05fb-49f1-88ea-40afc77e11b0" name="Address URL" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>75</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1fdb6c24-cd23-4d05-9d82-669a206fd6c8" name="Proxy Password" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>255</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="f1d8df06-7c75-439b-8060-907b70c874e9" name="Proxy Username" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>195</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f8ee2d04-68d3-4485-ac69-8d50ac5e405a" name="Proxy URL" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>135</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="277e93f5-f5ae-4a8e-814b-595831d7a6e9" name="Use Proxy" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>75</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6a4da17e-4dd2-4a0e-a66d-c75ae5b01c62" name="Content Type" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>195</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4886b192-278e-4686-b4ba-9763fedb22fb" name="Method" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>255</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fd39ba33-4cdc-452f-9d04-71afc90e234c" name="Headers" type="Collection"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>315</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="7e649850-4857-44d0-9c3b-52bfeefb3b52" name="Accept" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>375</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8c740af8-7fe7-4762-a61d-14e6e28ded8a" name="Username" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>315</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5494f1d3-4b37-417c-bc49-02d9928c6c5d" name="Password" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>375</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="3b6e0cb5-41d9-479f-8df1-bcb01eae7005" name="Certificate ID" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>435</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4485691a-4b81-47c6-818e-911f04c9869c" name="Force Pre Authorization" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>435</displayx><displayy>-180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="13c89c7d-dbbd-4718-805c-8b0bb9309550" name="statusCode" type="Data"><subsheetid>037d71ae-94af-4152-9ed2-893f3daa7477</subsheetid><narrative></narrative><displayx>135</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="48f03882-af30-479b-970f-b323480a279b" name="Add Tls12 Protocol" type="Action"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>11e111be-101c-4df7-9d5c-910a10c02e2d</onsuccess><resource object="Service Point Manager" action="Add Security Protocol - Tls12" /></stage><stage stageid="ffb0cc88-94e9-4ad0-8bc5-9735666577c6" name="Get Security Protols" type="Action"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="text" name="SecurityProtocol" stage="SecurityProtocol" /></outputs><onsuccess>c7d556e3-5bff-421c-83fa-847749ea0c87</onsuccess><resource object="Service Point Manager" action="Get Security Protocol" /></stage><stage stageid="050505bb-c89e-4790-9a05-d5d6dda6a299" name="SecurityProtocol" type="Data"><narrative></narrative><displayx>150</displayx><displayy>-15</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c7d556e3-5bff-421c-83fa-847749ea0c87" name="Is TLS12 Enabled?" type="Decision"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="InStr(Upper([SecurityProtocol]),&quot;TLS12&quot;)&gt;0" /><ontrue>9a3b7924-cd3d-4430-94aa-fe0ff085a1fe</ontrue><onfalse>48f03882-af30-479b-970f-b323480a279b</onfalse></stage><stage stageid="9a3b7924-cd3d-4430-94aa-fe0ff085a1fe" name="End1" type="End"><loginhibit /><narrative></narrative><displayx>105</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage></process></object>
        <object id="763f6d1e-e097-4cf4-9265-a095f7decc43" name="Utility - Http (Version 6)" xmlns="http://www.blueprism.co.uk/product/process"><process name="Utility - Http (Version 6)" version="6.3.0.6190" bpversion="6.4.3.13244" narrative="Communicates with web services using the HTTP protocol." byrefcollection="true" type="object" runmode="Exclusive"><appdef><element name="Application Root"><id>2ba17e26-49eb-43ed-84dd-c40e67e990b0</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>0</camerax><cameray>42</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="925e0261-2b2e-41ed-b555-4c5ccf8a00fc" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="f3a55ad6-3bfa-4401-baa9-0e50afe42879" type="Normal" published="True"><name>Post</name><view><camerax>109</camerax><cameray>56</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ecff5a78-99b1-4ecb-a356-a075c487ef71" type="Normal" published="True"><name>Post JSON</name><view><camerax>28</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d30e8f45-db72-40d2-9f17-9700006fe152" type="Normal" published="True"><name>HTTP Request</name><view><camerax>50</camerax><cameray>47</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="519a0dc7-b254-478b-b2ed-c7883124e31b" type="Normal" published="True"><name>Load Certificate</name><view><camerax>0</camerax><cameray>84</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="704436d5-f51b-4369-b763-a4fdc6e894c2" type="Normal" published="True"><name>URL Encode</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="bee831af-f964-4218-87f3-d3378e2eab10" name="Start" type="Start"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>071f13b7-de3d-4625-9498-9da634d452b4</onsuccess></stage><stage stageid="11e111be-101c-4df7-9d5c-910a10c02e2d" name="End" type="End"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="9c4d6f4e-1d32-4d1f-a37d-f279b42fa480" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><references><reference>System.Data.dll</reference><reference>System.Web.dll</reference><reference>System.Xml.dll</reference><reference>System.Web.dll</reference><reference>Newtonsoft.Json.dll</reference><reference>System.Net.Http.dll</reference></references><imports><import>System</import><import>System.Net</import><import>System.Data</import><import>System.Security.Cryptography.X509Certificates</import><import>System.Collections.Generic</import><import>System.Web</import><import>System.Media</import><import>System.IO</import><import>System.Text</import><import>Newtonsoft.Json</import><import>System.Net.Http.Headers</import></imports><language>visualbasic</language><globalcode><![CDATA[

]]></globalcode><code><![CDATA[Private m_Certificates As New Dictionary(Of String, X509Certificate2)

Private Function GetCertificate(ByVal subject As String) As X509Certificate2
	Dim store As New X509Store(StoreName.My, StoreLocation.LocalMachine)
	Try
		store.Open(OpenFlags.ReadOnly)
		Dim certs As X509Certificate2Collection = store.Certificates.Find(X509FindType.FindBySubjectName, subject, True)
		For Each cert As X509Certificate2 In certs
			Return cert
		Next
	Finally
		store.Close()
	End Try
	Return Nothing
End Function

Function ToDictionary(webResponse As HttpWebResponse ) As Dictionary(Of String, String)

	Dim dict = New Dictionary(Of String, String)()

	For index As Integer = 0 To webResponse.Headers.Count - 1

		If webResponse.Headers.Keys.Count -1 >= index Then

			dict.Add(webResponse.Headers.Keys(index), webResponse.Headers(index) )

		End if

	Next

	Return dict

End Function]]></code></stage><stage stageid="b48af877-43b3-4056-b8b4-88bac82a5c80" name="Clean Up" type="SubSheetInfo"><subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="d35cb9b6-000c-45e5-9a29-9001404a21d0" name="Start" type="Start"><subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>f1054fe8-46c8-42ab-b236-5b07592ec5eb</onsuccess></stage><stage stageid="f1054fe8-46c8-42ab-b236-5b07592ec5eb" name="End" type="End"><subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ab202953-451b-4e7c-8cd5-c050e06e286a" name="Post" type="SubSheetInfo"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative>Sends a message to HTTP endpoint using the POST method. The collection data is encoded using "application/x-www-form-urlencoded"</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="e2777b38-8eba-4a04-a611-28bcd6c4add6" name="Start" type="Start"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP Post data to" stage="Address URL" /><input type="collection" name="Post Data" narrative="A collection of values to send as Post data" stage="Post Data" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" /><input type="collection" name="Headers" narrative="OPTIONAL: HTTP Headers" stage="Headers" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" stage="Accept" /></inputs><onsuccess>e42b0caa-40c1-4a89-a873-f6977581053b</onsuccess></stage><stage stageid="f51a79a9-1213-484c-bedc-065f44051a02" name="End" type="End"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Post Headers" narrative="The headers related to the Post query" stage="ResultHeadersJson" /></outputs></stage><stage stageid="14154308-012d-47e4-a707-8ca80b73651e" name="new" type="Note"><subsheetid>925e0261-2b2e-41ed-b555-4c5ccf8a00fc</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="4228ae7a-9bb3-4de4-9bbf-00e32d925ecf" name="new" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="e42b0caa-40c1-4a89-a873-f6977581053b" name="Get Body" type="Code"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="postData" expr="[Post Data]" /></inputs><outputs><output type="text" name="body" stage="Body" /></outputs><onsuccess>e9085eba-5f15-4b65-91ed-41abf7c6917f</onsuccess><code><![CDATA[Dim sb As New System.Text.StringBuilder
For Each r As DataRow In postData.Rows
	Dim first As Boolean = True
	For Each c As DataColumn In postData.Columns
		If first Then
			first = False
		Else
			sb.Append("&")
		End If
		Dim columnName As String = c.ColumnName
		Dim encodedCol As String = System.Web.HttpUtility.UrlEncode(columnName)
		sb.Append(encodedCol)
		sb.Append("=")
		Dim val As String = r(columnName).ToString
		Dim encodedVal As String = System.Web.HttpUtility.UrlEncode(val)
		sb.Append(encodedVal)
	Next
	Exit For 'Only one row is allowed
Next

body=sb.ToString()
]]></code></stage><stage stageid="1c58d0fb-9a9b-4d2f-861f-5c22ab835c31" name="Result" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>-225</displayx><displayy>270</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b98abed4-9669-476c-87d9-3f485683d049" name="Address URL" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f4c2a5eb-36de-4904-a963-a8513b7e8840" name="Post Data" type="Collection"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="071f13b7-de3d-4625-9498-9da634d452b4" name="Setup" type="Code"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>11e111be-101c-4df7-9d5c-910a10c02e2d</onsuccess><code><![CDATA[System.Net.ServicePointManager.Expect100Continue = False]]></code></stage><stage stageid="f6ed43b3-714e-4161-b44b-b60490592281" name="Proxy Password" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="bcedbed1-3ed7-42d7-8f16-7e2071c3e187" name="Proxy Username" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="66afe5b7-37e4-4ed7-a9fc-a78e1ab8890c" name="Proxy URL" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="be7856fe-4027-4226-8caa-851bb6e7df21" name="Use Proxy" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="38c313e6-bc0d-49e5-a6ab-4042a0682d3d" name="Post JSON" type="SubSheetInfo"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative>Sends a message to HTTP endpoint using the POST method. The action expects a raw string and sets the content type to "application/json"</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="37166627-b66b-4a9c-a321-539933de2123" name="End" type="End"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Result Headers" narrative="The headers related to the Post Query" stage="ResultHeadersJson" /></outputs></stage><stage stageid="878a70a1-d658-4563-b27c-245f947b74be" name="Result" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>-255</displayx><displayy>195</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6875cda6-dbbe-47b6-ab82-b62f89c90a88" name="JSON" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4956e14f-001c-4406-a401-38c63ff06696" name="Start" type="Start"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP Post data to" stage="Address URL" /><input type="text" name="JSON" narrative="The JSON to send" stage="JSON" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers Collection" stage="Headers" /></inputs><onsuccess>6b571f09-555c-45a8-9475-957d41cafb24</onsuccess></stage><stage stageid="696696c8-af04-4075-aea0-a8024e2431fe" name="Address URL" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>-255</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="582df200-7287-4dc1-a9a2-6c9e09276f77" name="Proxy Password" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="924eb1dd-b782-4f71-82b6-9923ea0093ec" name="Proxy Username" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>-255</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ed09a5ed-6c7b-4dd3-9bf0-8df61da66ea3" name="Proxy URL" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5e35c8d6-3f97-4ae4-8566-35fb0981e145" name="Use Proxy" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>-255</displayx><displayy>30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4a9fcaf1-4310-45cb-a775-ebfadc75ac8a" name="Headers" type="Collection"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="9e64259d-1a91-444b-8620-b8cd186832d1" name="Accept" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="58e7a470-3ec3-4033-bb19-0fee1bdcaaed" name="HTTP Request" type="SubSheetInfo"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative>Sends a message to HTTP endpoint using the specified HTTP method and content-type</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="d0a11dcd-f002-46b5-aff6-1026c3be2da8" name="End" type="End"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" narrative="The returned headers response as Json" stage="ResultHeadersJson" /></outputs></stage><stage stageid="1fa7def4-c6a8-4325-9bc8-2c6027c0b8e8" name="HTTP Request" type="Code"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="addressURL" expr="[Address URL]" /><input type="text" name="body" expr="[Body]" /><input type="text" name="contentType" expr="[Content Type]" /><input type="text" name="method" expr="[Method]" /><input type="text" name="proxyURL" expr="[Proxy URL]" /><input type="flag" name="useProxy" expr="[Use Proxy]" /><input type="text" name="proxyUsername" expr="[Proxy Username]" /><input type="password" name="proxyPassword" expr="[Proxy Password]" /><input type="collection" name="headers" expr="[Headers]" /><input type="text" name="accept" expr="[Accept]" /><input type="text" name="username" expr="[Username]" /><input type="password" name="password" expr="[Password]" /><input type="text" name="certID" expr="[Certificate ID]" /><input type="flag" name="forcePreAuth" expr="[Force Pre Authorization]" /><input type="flag" name="usingFile" expr="[File]" /></inputs><outputs><output type="text" name="resultData" stage="Result" /><output type="text" name="resultHeadersJson" stage="ResultHeadersJson" /></outputs><onsuccess>d0a11dcd-f002-46b5-aff6-1026c3be2da8</onsuccess><code><![CDATA[Try
	Dim request As WebRequest = WebRequest.Create(addressURL)

	If forcePreAuth Then
	   'Sometimes a web server will require the authorisation header in the initial request
	   'In which case we have to add the basic authorization header manually.
	   Dim bytes() As Byte = System.Text.Encoding.UTF8.GetBytes(String.Format("{0}:{1}",username,password))
	   Dim base64 As String = Convert.ToBase64String(bytes)
	   request.Headers.Add("Authorization", "Basic " & base64)
	Else
	  If Not String.IsNullOrEmpty(username) AndAlso Not String.IsNullOrEmpty(password) Then
		request.Credentials = New NetworkCredential(username,password)
	  End If
	End If

	If useProxy Then
		Dim proxyURI As New Uri(proxyURL)
		Dim proxy As New WebProxy(proxyURI, True)
		Dim proxyCred As New NetworkCredential(proxyUsername, proxyPassword)
		Dim credCache As New CredentialCache()
		credCache.Add(proxyURI, "Basic", proxyCred)
		proxy.UseDefaultCredentials = False
		proxy.Credentials = credCache
		request.Proxy = proxy
	End If

	request.Method = method
	request.ContentType = contentType

	Dim httpRequest As HttpWebRequest = TryCast(request, HttpWebRequest)
	If httpRequest IsNot Nothing Then
	  If Not String.IsNullOrEmpty(accept) Then
		httpRequest.Accept = accept
	  End If
	  If Not String.IsNullOrEmpty(certID) Then
		httpRequest.ClientCertificates.Add(m_Certificates(certID))
	  End If
	End If

	For Each r As DataRow In headers.Rows
		For Each c As DataColumn In headers.Columns
			Dim columnName As String = c.ColumnName
			Dim val As String = r(columnName).ToString
			request.Headers.Add(columnName,val)
		Next
		Exit For 'Only one row is allowed
	Next

	' Normal stream writer, we aren't encoding a file etc.
	If Not usingFile Then

		If Not String.IsNullOrEmpty(body) Then
		  Dim requestStream As IO.Stream = request.GetRequestStream()
		  Using sw As New IO.StreamWriter(requestStream, New Text.UTF8Encoding(False))
			sw.Write(body)
		  End Using
		End If

	Else If usingFile Then
		' Prep the request body
		Dim byteArray = File.ReadAllBytes( body )
		Dim requestStream As IO.Stream = request.GetRequestStream()
		requestStream.Write(byteArray,0, byteArray.Length)
End If

	Using response As WebResponse = request.GetResponse()
	  resultHeadersJson = ToDictionary(response).ToString()
	  Dim responseStream As IO.Stream = response.GetResponseStream()
	  Dim sr As New IO.StreamReader(responseStream)
	  resultData = sr.ReadToEnd()
	End Using

Catch e As WebException

	Using response As WebResponse = e.Response
		Dim httpResponse As HttpWebResponse = CType(response, HttpWebResponse)
		Using data As Stream = response.GetResponseStream()
			Using reader = New StreamReader(data)
				Dim text As String = reader.ReadToEnd()
				resultData = resultData + text
			End Using

		End Using
	End Using

End Try]]></code></stage><stage stageid="96e2df5a-429a-4030-9565-b8cbbf7be6b3" name="Result" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-225</displayx><displayy>375</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8f28cc4e-4ae2-4b01-ad23-0b632027d627" name="Body" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e305dce1-1fd7-459b-8211-27c26350676d" name="Block1" type="Block"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>-60</displayx><displayy>-45</displayy><displaywidth>210</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="0e0138a9-ccaa-44b1-b742-ad843c39aca1" name="Recover1" type="Recover"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>90</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0645751f-e202-459a-b704-5fb0e0cbebe7</onsuccess></stage><stage stageid="0645751f-e202-459a-b704-5fb0e0cbebe7" name="Exception1" type="Exception"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="" detail="" usecurrent="yes" /></stage><stage stageid="d8c39895-52d1-45ad-8cd0-be309896d0e5" name="Start" type="Start"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>-75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" stage="Address URL" /><input type="text" name="Body" narrative="The body text of the HTTP request" stage="Body" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" stage="Use Proxy" /><input type="text" name="Content Type" narrative="The content type of the HTTP request." stage="Content Type" /><input type="text" name="Method" narrative="The method of the HTTP request." stage="Method" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" stage="Proxy URL" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" stage="Proxy Username" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" stage="Proxy Password" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" stage="Headers" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" stage="Accept" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" stage="Username" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" stage="Password" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" stage="Certificate ID" /><input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" stage="Force Pre Authorization" /><input type="flag" name="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" stage="File" /></inputs><onsuccess>1fa7def4-c6a8-4325-9bc8-2c6027c0b8e8</onsuccess></stage><stage stageid="c4e87c4e-8150-4a15-8fc5-ddc736b949ae" name="Address URL" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="038a7411-25dc-456c-8007-bb82f3d94de7" name="Proxy Password" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>210</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="8ef02e3a-8214-4163-b44d-a5081ed8b9e4" name="Proxy Username" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>210</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1c6f3a8d-428e-4a61-815c-f32a8a117ae3" name="Proxy URL" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>165</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5c4cc5f6-0531-4375-b9c1-3fcb529dde9b" name="Use Proxy" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>165</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4a98d0d5-c3b8-42fb-933f-2168265f12d6" name="Content Type" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="fc9f21c4-39ba-4135-8356-f9a516bf6b99" name="Method" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6b571f09-555c-45a8-9475-957d41cafb24" name="HTTP Request" type="SubSheet"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[Address URL]" /><input type="text" name="Body" narrative="The body text of the HTTP request" expr="[JSON]" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="[Use Proxy]" /><input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/json&quot;" /><input type="text" name="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="[Proxy URL]" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="[Proxy Username]" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="[Proxy Password]" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" expr="[Headers]" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" /><input type="flag" name="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" /></inputs><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" narrative="The returned headers response as Json" stage="ResultHeadersJson" /></outputs><onsuccess>37166627-b66b-4a9c-a321-539933de2123</onsuccess><processid>d30e8f45-db72-40d2-9f17-9700006fe152</processid></stage><stage stageid="33b3447c-a55e-4af3-be35-6cb5624d6a4f" name="Headers" type="Collection"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="ac16a164-f018-4111-949f-3db9d4d873d9" name="Accept" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="23c8dd77-277a-4aac-8df7-31c951626abd" name="Body" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>195</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e9085eba-5f15-4b65-91ed-41abf7c6917f" name="HTTP Request" type="SubSheet"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Address URL" narrative="The URL to send the HTTP data to" expr="[Address URL]" /><input type="text" name="Body" narrative="The body text of the HTTP request" expr="[Body]" /><input type="flag" name="Use Proxy" narrative="Set true if you need to use a proxy" expr="[Use Proxy]" /><input type="text" name="Content Type" narrative="The content type of the HTTP request." expr="&quot;application/x-www-form-urlencoded&quot;" /><input type="text" name="Method" narrative="The method of the HTTP request." expr="&quot;POST&quot;" /><input type="text" name="Proxy URL" narrative="OPTIONAL: The proxy url" expr="[Proxy URL]" /><input type="text" name="Proxy Username" narrative="OPTIONAL: The proxy username" expr="[Proxy Username]" /><input type="password" name="Proxy Password" narrative="OPTIONAL: The proxy password" expr="[Proxy Password]" /><input type="collection" name="Headers" narrative="OPTIONAL: Headers" expr="[Headers]" /><input type="text" name="Accept" narrative="OPTIONAL: Accept" expr="[Accept]" /><input type="text" name="Username" narrative="OPTIONAL: Basic Authentication username" expr="" /><input type="password" name="Password" narrative="OPTIONAL: Basic Authenction password" expr="" /><input type="text" name="Certificate ID" narrative="OPTIONAL: The id of the client authentication certificate" expr="" /><input type="flag" name="Force Pre Authorization" narrative="OPTIONAL: Force the request to send the authorization headers" expr="" /><input type="flag" name="File URL" narrative="OPTIONAL: Is the JSON Body a file instead?" expr="" /></inputs><outputs><output type="text" name="Result" narrative="The result from the Post query." stage="Result" /><output type="text" name="Headers as Json" narrative="The returned headers response as Json" stage="ResultHeadersJson" /></outputs><onsuccess>f51a79a9-1213-484c-bedc-065f44051a02</onsuccess><processid>d30e8f45-db72-40d2-9f17-9700006fe152</processid></stage><stage stageid="4bd01e67-49a4-4082-be0d-df1bb9cecb13" name="Username" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>255</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dac70b0c-83cb-4605-8f7b-d1d8d21922d3" name="Password" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>255</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="9091a189-b87b-4ed7-9747-1e1e9fe657f6" name="Load Certificate" type="SubSheetInfo"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="3cff8803-c15f-4ab4-a032-d0afb9fa20ae" name="Start" type="Start"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Filename" narrative="OPTIONAL: The full path to a file containing the certificate" stage="Filename" /><input type="text" name="Subject" narrative="OPTIONAL: The subject of the certificate if loading from the store" stage="Subject" /><input type="password" name="Password" narrative="OPTIONAL: The password to load the certificate if needed" stage="Password" /></inputs><onsuccess>8962b858-f6e2-413c-9ceb-3d80dee88de2</onsuccess></stage><stage stageid="17fddf56-07f2-4942-8515-e1b183458a7f" name="End" type="End"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Certificate ID" narrative="The ID of the certificate" stage="Certificate ID" /></outputs></stage><stage stageid="e9b8de2b-8e54-4772-b186-046ca262c94c" name="Filename" type="Data"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5f0ec822-a1c0-4b6b-91ba-739b0b2762b8" name="Subject" type="Data"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8962b858-f6e2-413c-9ceb-3d80dee88de2" name="Load" type="Code"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="filename" expr="[Filename]" /><input type="password" name="password" expr="[Password]" /><input type="text" name="subject" expr="[Subject]" /></inputs><outputs><output type="text" name="thumbprint" stage="Certificate ID" /></outputs><onsuccess>17fddf56-07f2-4942-8515-e1b183458a7f</onsuccess><code><![CDATA[Dim cert As X509Certificate2 = Nothing
If Not String.IsNullOrEmpty(filename) Then
  cert = New X509Certificate2(filename,password)
End If

If Not String.IsNullOrEmpty(subject) Then
  cert=GetCertificate(subject)
End If

thumbprint = cert.Thumbprint
m_Certificates.Add(thumbprint,cert)
]]></code></stage><stage stageid="745e7557-7761-4078-8ff7-334b6873f126" name="Certificate ID" type="Data"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="471ae54f-286f-4472-b48c-114fc7d04bf9" name="Password" type="Data"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="452476e7-b29f-4e5f-999a-c67789bbb0db" name="Certificate ID" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>300</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5de144f5-aa91-46e0-8f9c-ac8495d2ab0c" name="Force Pre Authorization" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c83483da-e145-4802-8407-a40cf74fc86a" name="URL Encode" type="SubSheetInfo"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="f640efd4-cb34-48ee-b07d-de356b07b09b" name="Start" type="Start"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="URL" narrative="The URL to encode" stage="URL" /></inputs><onsuccess>d0c241bd-a746-44fc-9fdd-5f73a4c55bf9</onsuccess></stage><stage stageid="0d4cffb2-879f-49d1-b815-43da8446a39c" name="End" type="End"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="text" name="URL" narrative="The encoded URL" stage="URL" /></outputs></stage><stage stageid="d0c241bd-a746-44fc-9fdd-5f73a4c55bf9" name="Encode URL" type="Code"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="URL" expr="[URL]" /></inputs><outputs><output type="text" name="Encoded URL" stage="URL" /></outputs><onsuccess>0d4cffb2-879f-49d1-b815-43da8446a39c</onsuccess><code><![CDATA[
Encoded_URL = HttpUtility.UrlEncode( URL )]]></code></stage><stage stageid="7a1cd30a-feef-4786-89fd-cf1838f4dfaa" name="URL" type="Data"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e627cc07-7d3a-40bd-a02a-0a2952f079d0" name="Headers" type="Collection"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>-255</displayx><displayy>120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="FF6600" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="495a88d6-260c-4b89-a04c-64a12af7b759" name="File" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="765d4221-5509-4c70-97c4-a946b7d3d186" name="ResultHeadersJson" type="Data"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>375</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ea993d2e-35df-484b-9c46-a2d69a172ceb" name="ResultHeadersJson" type="Data"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>195</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="031e4c4f-fa80-4e54-b2ab-847483e49414" name="ResultHeadersJson" type="Data"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>270</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="caabb2b2-6772-4932-8ad6-0695d1a170d9" name="Inputs" type="Block"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><narrative></narrative><displayx>-300</displayx><displayy>-45</displayy><displaywidth>210</displaywidth><displayheight>195</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="ae023e33-e349-4bf0-80e0-7e3794a1dbc2" name="Protected Variables" type="Block"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>165</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="76b976d1-2b36-4ea6-8c01-04fa5ea31f20" name="Outputs" type="Block"><subsheetid>f3a55ad6-3bfa-4401-baa9-0e50afe42879</subsheetid><loginhibit /><narrative></narrative><displayx>-300</displayx><displayy>240</displayy><displaywidth>210</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="4b809006-50ee-41b3-b1db-2bc0165f895f" name="Inputs" type="Block"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><narrative></narrative><displayx>-315</displayx><displayy>-45</displayy><displaywidth>210</displaywidth><displayheight>195</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="2e4c34da-85e1-4b3d-86a2-de7a6b10fcf6" name="Outputs" type="Block"><subsheetid>ecff5a78-99b1-4ecb-a356-a075c487ef71</subsheetid><loginhibit /><narrative></narrative><displayx>-315</displayx><displayy>165</displayy><displaywidth>210</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="cad4106c-2c71-48d0-960d-4d2c78a91eff" name="Inputs" type="Block"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>-300</displayx><displayy>-45</displayy><displaywidth>210</displaywidth><displayheight>375</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="a42642fa-1d93-42e4-942a-cb7a7087efef" name="Outputs" type="Block"><subsheetid>d30e8f45-db72-40d2-9f17-9700006fe152</subsheetid><loginhibit /><narrative></narrative><displayx>-300</displayx><displayy>345</displayy><displaywidth>210</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="4a325f2f-9650-490c-b4bb-61928ef10e68" name="Inputs" type="Block"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><narrative></narrative><displayx>-300</displayx><displayy>-45</displayy><displaywidth>210</displaywidth><displayheight>105</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="67c03883-48e2-4ef1-8e3a-98ca0652e901" name="Outputs" type="Block"><subsheetid>519a0dc7-b254-478b-b2ed-c7883124e31b</subsheetid><loginhibit /><narrative></narrative><displayx>-300</displayx><displayy>90</displayy><displaywidth>210</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="1d4b7d60-b4f9-48d1-8e90-6759e1bfc573" name="Input / Output" type="Block"><subsheetid>704436d5-f51b-4369-b763-a4fdc6e894c2</subsheetid><loginhibit /><narrative></narrative><displayx>-285</displayx><displayy>-45</displayy><displaywidth>210</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage></process></object>
        <object-group id="a27e0c21-8a66-4938-9767-f5ddf49d47fe" name="Blue_Prism/Utilities" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="07907aae-4208-4670-8fd3-61b7abb63671" />
                <object id="763f6d1e-e097-4cf4-9265-a095f7decc43" />
            </members>
        </object-group>
        <object-group id="85230b43-2396-4b62-8228-f970ffd609e7" name="Default" isDefaultGroup="True" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="8986fb8f-b8fd-4922-971b-f9f9b8a3950f" />
            </members>
        </object-group>
    </bpr:contents>
</bpr:release>